<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{master.html}">
<head>
    <title th:text="${banner.id == null} ? 'Nuevo Banner' : 'Editar Banner'">Formulario de Banner</title>
</head>
<body>
<div class="container" layout:fragment="content">

    <h2 class="mb-3" th:text="${banner.id == null} ? 'Nuevo Banner' : 'Editar Banner'">Formulario de Banner</h2>

    <div th:if="${msgError != null}" class="alert alert-danger" role="alert">
        [[${msgError}]]
    </div>

    <form th:action="@{/admin/banners/guardar}" method="post" th:object="${banner}"
          enctype="multipart/form-data">

        <input type="hidden" th:field="*{id}">
        <input type="hidden" th:field="*{imagenNombre}">

        <div class="row g-3">

            <div class="col-md-6">
                <label for="titulo" class="form-label">Título (Texto principal del banner)</label>
                <input type="text" class="form-control" id="titulo" th:field="*{titulo}" placeholder="Ej: ¡Ofertas de Verano!">
            </div>

            <div class="col-md-6">
                <label for="archivoImagen" class="form-label">Imagen de Fondo</label>
                <input type="file" class="form-control" id="archivoImagen" name="archivoImagen" accept="image/jpeg, image/png, image/webp">
                <div class="form-text" th:if="${banner.id == null}">* Requerido para crear un nuevo banner.</div>

                <div th:if="${banner.id != null AND banner.imagenNombre != null}" class="mt-2">
                    <small>Imagen actual:</small><br>
                    <img th:src="@{${banner.getImagenFondoUrl()}}" th:alt="${banner.titulo}" style="width: 200px; height: auto; border-radius: 5px;">
                </div>
            </div>

            <div class="col-md-6">
                <label for="subtitulo" class="form-label">Subtítulo (Texto del banner)</label>
                <input type="text" class="form-control" id="subtitulo" th:field="*{subtitulo}" placeholder="Ej: Hasta 50% de descuento">
            </div>

            <div class="col-md-6">
                <label for="textoBoton" class="form-label">Texto del Botón</label>
                <input type="text" class="form-control" id="textoBoton" th:field="*{textoBoton}" placeholder="Ej: Ver Ofertas">
            </div>

            <div class="col-md-6">
                <label for="enlaceBoton" class="form-label">Enlace del Botón (URL)</label>
                <input type="text" class="form-control" id="enlaceBoton" th:field="*{enlaceBoton}" placeholder="Ej: /catalogo/ofertas">
            </div>

            <div class="col-md-6">
                <label for="orden" class="form-label">Orden</label>

                <input type="number" class="form-control" id="orden" th:field="*{orden}"
                       th:classappend="${#fields.hasErrors('orden')} ? 'is-invalid' : ''">

                <div class="form-text" th:unless="${#fields.hasErrors('orden')}">
                    El número más bajo (ej: 1) aparece primero.
                </div>

                <div class="invalid-feedback" th:if="${#fields.hasErrors('orden')}" th:errors="*{orden}">
                    Error en el orden.
                </div>
            </div>

            <div class="col-md-6 d-flex align-items-center">
                <div class="form-check form-switch mt-4">
                    <input class="form-check-input" type="checkbox" role="switch" id="estaActivo" th:field="*{estaActivo}">
                    <label class="form-check-label" for="estaActivo">¿Está Activo? (Visible en el Home)</label>
                </div>
            </div>
        </div>

        <div class="mt-4">
            <button type="submit" class="btn btn-success">Guardar Banner</button>
            <a th:href="@{/admin/banners}" class="btn btn-secondary">Cancelar</a>
        </div>

    </form>

</div>
</body>
</html>